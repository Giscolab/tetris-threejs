@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500;700&display=swap');

:root {
  --steel-950: #11151a;
  --steel-900: #181d24;
  --steel-800: #232a33;
  --steel-700: #313b46;

  --platinum-200: #c6ced8;
  --platinum-100: #e6ebf1;
  --copper-500: #8d6855;
  --copper-300: #ab866f;

  --line-0: rgba(230, 235, 241, 0.08);
  --line-1: rgba(230, 235, 241, 0.16);
  --line-2: rgba(230, 235, 241, 0.26);
  --line-copper: rgba(173, 134, 111, 0.55);

  --glass-a: rgba(17, 21, 26, 0.58);
  --glass-b: rgba(24, 29, 36, 0.52);

  --text-main: rgba(230, 235, 241, 0.92);
  --text-dim: rgba(230, 235, 241, 0.58);

  --spring: cubic-bezier(0.22, 1, 0.36, 1);
  --spring-hard: cubic-bezier(0.34, 1.4, 0.64, 1);
}

*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html,
body {
  width: 100%;
  height: 100%;
  overflow: hidden;
}

body {
  font-family: 'IBM Plex Mono', 'JetBrains Mono', ui-monospace, monospace;
  letter-spacing: -0.01em;
  color: var(--text-main);
  background: var(--steel-950);
  text-rendering: geometricPrecision;
  -webkit-font-smoothing: antialiased;
}

body::before,
body::after {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 35;
}

body::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 240 240'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.82' numOctaves='3'/%3E%3C/filter%3E%3Crect width='240' height='240' filter='url(%23n)' opacity='0.18'/%3E%3C/svg%3E");
  background-size: 170px 170px;
  opacity: 0.24;
  mix-blend-mode: soft-light;
}

body::after {
  background:
    repeating-linear-gradient(90deg, transparent 0 29px, rgba(230, 235, 241, 0.05) 29px 30px),
    repeating-linear-gradient(0deg, transparent 0 29px, rgba(230, 235, 241, 0.04) 29px 30px);
  opacity: 0.14;
}

.machine-frame {
  position: fixed;
  inset: 0;
}

#canvas-container {
  position: absolute;
  inset: 0;
  z-index: 1;
}

#canvas-container canvas {
  width: 100%;
  height: 100%;
  display: block;
}

#hud {
  position: absolute;
  inset: 0;
  z-index: 10;
  pointer-events: none;
  display: grid;
  grid-template-columns: minmax(115px, 12vw) 1fr minmax(220px, 22vw) minmax(115px, 12vw);
  grid-template-rows: auto 1fr auto;
  gap: clamp(10px, 1.5vw, 22px);
  padding: clamp(10px, 1.3vw, 22px);
}

.data-display,
.radar-panel,
#start-modal nav,
#play-button,
kbd {
  border: 1px solid var(--line-1);
  background: linear-gradient(160deg, var(--glass-a), var(--glass-b));
  backdrop-filter: blur(9px) saturate(0.95);
  -webkit-backdrop-filter: blur(9px) saturate(0.95);
}

.data-display::before,
.radar-panel::before,
.radar-panel::after {
  content: '';
  position: absolute;
  pointer-events: none;
}

.hud-head,
.hud-foot {
  grid-column: 1 / -1;
  position: relative;
  min-height: 30px;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  mix-blend-mode: screen;
}

.hud-head { justify-content: flex-end; }
.hud-foot { justify-content: flex-start; }

.hud-head::before,
.hud-foot::before {
  inset: 1px;
  border: 1px solid var(--line-0);
}

.tag,
.coord {
  font-size: clamp(0.56rem, 0.7vw, 0.68rem);
  letter-spacing: 0.11em;
  color: var(--text-dim);
  padding: 0.22rem 0.42rem;
  border: 1px solid rgba(230, 235, 241, 0.11);
  background: rgba(35, 42, 51, 0.42);
}

#hold-panel,
#next-panel {
  position: relative;
  align-self: start;
  min-height: clamp(145px, 19vh, 236px);
  mix-blend-mode: screen;
  overflow: hidden;
}

#hold-panel { grid-column: 1; grid-row: 2; }
#next-panel { grid-column: 4; grid-row: 2; }

.radar-panel::before {
  inset: 0;
  background:
    linear-gradient(transparent calc(50% - 0.5px), rgba(230, 235, 241, 0.15) calc(50% - 0.5px) calc(50% + 0.5px), transparent calc(50% + 0.5px)),
    linear-gradient(90deg, transparent calc(50% - 0.5px), rgba(230, 235, 241, 0.15) calc(50% - 0.5px) calc(50% + 0.5px), transparent calc(50% + 0.5px)),
    repeating-linear-gradient(0deg, transparent 0 31px, rgba(230, 235, 241, 0.045) 31px 32px),
    repeating-linear-gradient(90deg, transparent 0 31px, rgba(230, 235, 241, 0.045) 31px 32px);
}

.radar-panel::after {
  inset: 8px;
  border: 1px solid rgba(230, 235, 241, 0.1);
  clip-path: polygon(8% 0, 92% 0, 100% 8%, 100% 92%, 92% 100%, 8% 100%, 0 92%, 0 8%);
}

.panel-title {
  position: absolute;
  top: 8px;
  left: 8px;
  font-size: 0.65rem;
  letter-spacing: 0.23em;
  color: var(--text-dim);
}

#stats-panel {
  grid-column: 3;
  grid-row: 2;
  align-self: start;
  display: grid;
  gap: 8px;
}

.stat {
  position: relative;
  min-height: clamp(84px, 10.5vh, 130px);
  padding: 11px 14px;
  display: grid;
  align-content: center;
  transition: transform 260ms var(--spring-hard), border-color 220ms steps(4, end);
  mix-blend-mode: screen;
}

.stat::before {
  inset: 1px;
  border: 1px solid rgba(230, 235, 241, 0.06);
}

.stat::after {
  content: '';
  position: absolute;
  left: 10px;
  right: 10px;
  bottom: 7px;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--line-copper), transparent);
  opacity: 0.42;
}

.stat:hover {
  transform: translateY(-2px);
  border-color: var(--line-2);
}

.stat-label {
  font-size: clamp(0.58rem, 0.77vw, 0.78rem);
  letter-spacing: 0.19em;
  color: var(--text-dim);
}

.stat-value {
  margin-top: 0.22rem;
  font-family: 'JetBrains Mono', monospace;
  font-size: clamp(2.02rem, 3.8vw, 3.4rem);
  font-weight: 500;
  font-variant-numeric: tabular-nums;
  color: var(--platinum-100);
  line-height: 0.95;
  letter-spacing: -0.045em;
  transition: transform 190ms var(--spring), filter 180ms steps(5, end);
}

.value-update-flash {
  animation: score-flicker 460ms steps(6, end);
}

@keyframes score-flicker {
  0% { transform: translateX(0); text-shadow: none; opacity: 1; }
  20% { transform: translateX(-1px); text-shadow: -1px 0 rgba(230, 235, 241, 0.45), 1px 0 rgba(141, 104, 85, 0.38); opacity: 0.92; }
  42% { transform: translateX(1px); text-shadow: 1px 0 rgba(230, 235, 241, 0.5), -1px 0 rgba(141, 104, 85, 0.45); opacity: 1; }
  64% { transform: translateX(0); filter: contrast(1.05); }
  100% { transform: translateX(0); text-shadow: none; filter: none; opacity: 1; }
}

.stat-value:hover {
  animation: chroma 340ms steps(4, end) 1;
}

@keyframes chroma {
  0%, 100% { text-shadow: none; }
  48% { text-shadow: -1px 0 rgba(230, 235, 241, 0.3), 1px 0 rgba(173, 134, 111, 0.4); }
}

.system-overlay {
  position: fixed;
  inset: 0;
  z-index: 30;
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  text-align: center;
  background: rgba(17, 21, 26, 0.55);
  border: 1px solid rgba(230, 235, 241, 0.13);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

.system-overlay h2 {
  color: var(--platinum-100);
  font-size: clamp(1.6rem, 3vw, 2.9rem);
  letter-spacing: 0.2em;
}

.system-overlay p {
  margin-top: 0.72rem;
  font-size: 0.82rem;
  color: var(--text-dim);
  letter-spacing: 0.12em;
}

#start-modal {
  position: fixed;
  inset: 0;
  z-index: 50;
  display: grid;
  place-content: center;
  justify-items: center;
  gap: 14px;
  padding: 20px;
  background: rgba(17, 21, 26, 0.64);
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
}

#start-modal h1 {
  font-size: clamp(1.5rem, 3.5vw, 2.7rem);
  font-weight: 500;
  letter-spacing: 0.21em;
  color: var(--platinum-100);
  border-bottom: 1px solid var(--line-copper);
  padding-bottom: 0.4rem;
}

#start-modal nav {
  position: relative;
  padding: 12px 14px;
}

#start-modal nav::before {
  content: '';
  position: absolute;
  inset: 1px;
  border: 1px solid var(--line-0);
}

#start-modal ul {
  list-style: none;
  display: grid;
  gap: 6px;
}

#start-modal li {
  font-size: 0.74rem;
  letter-spacing: 0.045em;
  color: var(--text-dim);
}

kbd {
  font: inherit;
  font-size: 0.72rem;
  color: var(--text-main);
  padding: 0.12rem 0.4rem;
}

#play-button {
  pointer-events: auto;
  cursor: pointer;
  color: var(--platinum-100);
  text-transform: uppercase;
  letter-spacing: 0.22em;
  font-family: inherit;
  font-size: 0.75rem;
  padding: 0.7rem 1.58rem;
  transition: transform 240ms var(--spring-hard), border-color 180ms steps(3, end);
}

#play-button:hover {
  transform: translateY(-1px);
  border-color: var(--line-copper);
}

#play-button:active {
  transform: translateY(1px) scale(0.99);
}

@media (max-width: 1000px) {
  #hud {
    grid-template-columns: 95px 1fr 170px 95px;
  }

  .stat-value {
    font-size: clamp(1.45rem, 5.1vw, 2.2rem);
  }

  .coord:last-child,
  .tag:first-child {
    display: none;
  }
}

@media (max-width: 760px) {
  #hud {
    grid-template-columns: 74px 1fr 140px 74px;
    gap: 8px;
    padding: 8px;
  }

  #hold-panel,
  #next-panel {
    min-height: 118px;
  }

  .stat {
    min-height: 72px;
    padding: 8px 10px;
  }

  #start-modal h1 {
    letter-spacing: 0.12em;
  }
}
